<script src="http://192.168.1.71:3000/socket.io/socket.io.js"></script>
<script>
       var randData = makeid();
		console.log("[iComission socket] Initiating connection to the server...");
		var socket = io.connect("http://192.168.1.71:3000/");
            socket.on('welcome', function(data) {
                // Respond with a message including this clients' id sent from the server
				console.log("[iComission socket] Got welcome packet, running handshake..");
                socket.emit('__INIT', {message: randData, id: data.id});
            });
            socket.on('__SERVINIT', function(data){
				console.log("Server replied to handshake, JSON:"+JSON.stringify(data));
				if(data.UUID == randData){
					console.log("Data matches, connection accepted!, sending username for server.");
					socket.emit("__COMPLETE",{USERNAME: "not"});
					socket.on("__DONE",function(data){
					console.log("Connection complete, your IDs are: " + JSON.stringify(data.IDS));
					socket.emit("broadcast", {scope:"myth",key:"TEST",value:"POO"});
					});
				}
			});
			socket.on('TEST',function(data){
			  alert(data);
			});
			
function makeid()
{
    var text = "";
    var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

    for( var i=0; i < 20; i++ )
        text += possible.charAt(Math.floor(Math.random() * possible.length));

    return text;
}
</script>